---
import Age from './Age'
import Highlight from './Highlight.astro'

const { class: className } = Astro.props
---

<div class:list={['text-lg text-pretty', className]}>
  <p>
    Hey! I'm <Highlight>Kirill Tregubov</Highlight>, a
    <Age client:load /> year-old
    <Highlight>software developer</Highlight> based in <span
      class="whitespace-nowrap"
      ><span class="canadian-flag" aria-hidden>ðŸ‡¨ðŸ‡¦</span>Canada</span
    >. I specialize in TypeScript and spend most of my time building CLI tools
    and modern web, mobile and desktop apps using React. My preferred tech stack
    includes React Native, Tauri (Rust), Vite, TailwindCSS, Node.js and
    PostgreSQL. I also graduated from the University of Toronto with an{' '}
    <Highlight>Honours Bachelor of Science in Computer Science</Highlight>. I'm
    passionate about <span class="whitespace-nowrap">open-source</span> software,
    interface design, science fiction and astronomy.
  </p>
  <script is:inline>
    function isCanadianFlagSupported() {
      const emoji = 'ðŸ‡¨ðŸ‡¦'
      const c = document.createElement('canvas')
      const ctx = c.getContext('2d')
      if (!ctx) return false

      c.width = c.height = 20
      ctx.textBaseline = 'top'
      ctx.font = '20px sans-serif'
      ctx.fillText(emoji, 0, 0)

      const data = ctx.getImageData(0, 0, c.width, c.height).data

      let redPixels = 0,
        totalPixels = 0
      for (let i = 0; i < data.length; i += 4) {
        const [r, g, b, a] = data.slice(i, i + 4)
        if (!a) continue
        totalPixels++
        if (r > 150 && r > 1.3 * g && r > 1.3 * b) redPixels++
      }

      // If at least ~5% of pixels are clearly red, assume the flag rendered.
      return redPixels / totalPixels > 0.05
    }

    document.addEventListener('astro:page-load', () => {
      if (window.location.pathname !== '/') {
        return
      }

      const showFlag = isCanadianFlagSupported()
      const flags = document.querySelectorAll('.canadian-flag')
      flags.forEach((button) => {
        if (!showFlag) {
          button.textContent = ''
          button.innerHTML =
            '<img src="/assets/canada.svg" alt="Canada" class="inline-block size-[1em] w-auto align-middle mb-[2px] mr-px" />'
        }
      })
    })
  </script>
  <p class="mt-4">
    If you want to get in touch, feel free to email me at{' '}
    <span class="whitespace-nowrap">
      <a
        href="mailto:contact@kirilltregubov.com"
        class="relative -m-0.5 rounded-sm p-0.5 font-medium text-neutral-200 transition-shadow after:absolute after:right-0.5 after:bottom-0 after:left-0.5 after:h-0.5 after:w-[calc(100%-0.25rem)] after:origin-bottom-left after:scale-x-100 after:rounded-full after:bg-gradient-to-r after:from-accent-700 after:to-accent-400 after:transition-transform after:duration-500 after:ease-in-out after:will-change-transform after:content-[''] hover:after:origin-bottom-right hover:after:scale-x-0"
        draggable="false">contact@kirilltregubov.com</a
      >.
    </span>
  </p>
  <div class="social-buttons mt-6 flex gap-4 leading-none 2xl:mt-5">
    <a
      href="https://github.com/KirillTregubov"
      target="_blank"
      rel="noopener"
      aria-label="Kirill's GitHub"
    >
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50">
        <title>GitHub</title>
        <path
          d="M17.791,46.836C18.502,46.53,19,45.823,19,45v-5.4c0-0.197,0.016-0.402,0.041-0.61C19.027,38.994,19.014,38.997,19,39 c0,0-3,0-3.6,0c-1.5,0-2.8-0.6-3.4-1.8c-0.7-1.3-1-3.5-2.8-4.7C8.9,32.3,9.1,32,9.7,32c0.6,0.1,1.9,0.9,2.7,2c0.9,1.1,1.8,2,3.4,2 c2.487,0,3.82-0.125,4.622-0.555C21.356,34.056,22.649,33,24,33v-0.025c-5.668-0.182-9.289-2.066-10.975-4.975 c-3.665,0.042-6.856,0.405-8.677,0.707c-0.058-0.327-0.108-0.656-0.151-0.987c1.797-0.296,4.843-0.647,8.345-0.714 c-0.112-0.276-0.209-0.559-0.291-0.849c-3.511-0.178-6.541-0.039-8.187,0.097c-0.02-0.332-0.047-0.663-0.051-0.999 c1.649-0.135,4.597-0.27,8.018-0.111c-0.079-0.5-0.13-1.011-0.13-1.543c0-1.7,0.6-3.5,1.7-5c-0.5-1.7-1.2-5.3,0.2-6.6 c2.7,0,4.6,1.3,5.5,2.1C21,13.4,22.9,13,25,13s4,0.4,5.6,1.1c0.9-0.8,2.8-2.1,5.5-2.1c1.5,1.4,0.7,5,0.2,6.6c1.1,1.5,1.7,3.2,1.6,5 c0,0.484-0.045,0.951-0.11,1.409c3.499-0.172,6.527-0.034,8.204,0.102c-0.002,0.337-0.033,0.666-0.051,0.999 c-1.671-0.138-4.775-0.28-8.359-0.089c-0.089,0.336-0.197,0.663-0.325,0.98c3.546,0.046,6.665,0.389,8.548,0.689 c-0.043,0.332-0.093,0.661-0.151,0.987c-1.912-0.306-5.171-0.664-8.879-0.682C35.112,30.873,31.557,32.75,26,32.969V33 c2.6,0,5,3.9,5,6.6V45c0,0.823,0.498,1.53,1.209,1.836C41.37,43.804,48,35.164,48,25C48,12.318,37.683,2,25,2S2,12.318,2,25 C2,35.164,8.63,43.804,17.791,46.836z"
        ></path>
      </svg>
    </a><a
      href="https://www.linkedin.com/in/kirilltregubov/"
      target="_blank"
      rel="noopener"
      aria-label="Kirill's LinkedIn"
    >
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50">
        <title>LinkedIn</title>
        <path
          d="M 8 3.0097656 C 4.53 3.0097656 2.0097656 5.0892187 2.0097656 7.9492188 C 2.0097656 10.819219 4.59 12.990234 8 12.990234 C 11.47 12.990234 13.990234 10.870625 13.990234 7.890625 C 13.830234 5.020625 11.36 3.0097656 8 3.0097656 z M 3 15 C 2.45 15 2 15.45 2 16 L 2 45 C 2 45.55 2.45 46 3 46 L 13 46 C 13.55 46 14 45.55 14 45 L 14 16 C 14 15.45 13.55 15 13 15 L 3 15 z M 18 15 C 17.45 15 17 15.45 17 16 L 17 45 C 17 45.55 17.45 46 18 46 L 27 46 C 27.552 46 28 45.552 28 45 L 28 30 L 28 29.75 L 28 29.5 C 28 27.13 29.820625 25.199531 32.140625 25.019531 C 32.260625 24.999531 32.38 25 32.5 25 C 32.62 25 32.739375 24.999531 32.859375 25.019531 C 35.179375 25.199531 37 27.13 37 29.5 L 37 45 C 37 45.552 37.448 46 38 46 L 47 46 C 47.55 46 48 45.55 48 45 L 48 28 C 48 21.53 44.529063 15 36.789062 15 C 33.269062 15 30.61 16.360234 29 17.490234 L 29 16 C 29 15.45 28.55 15 28 15 L 18 15 z"
        ></path>
      </svg>
    </a><a
      href="https://x.com/KirillTregubov_"
      target="_blank"
      rel="noopener"
      aria-label="Kirill's X (formerly Twitter)"
    >
      <svg
        viewBox="0 0 1200 1227"
        xmlns="http://www.w3.org/2000/svg"
        class="p-0.5"
      >
        <title>X (formerly Twitter)</title>
        <path
          d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z"
        ></path>
      </svg>
    </a>
  </div>
</div>
